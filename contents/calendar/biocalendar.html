<script>
// -----------------------------
// バイオリズム描画（記号で表示）
// -----------------------------
function drawBiorhythm(birthDate, year, month) {
  const canvas = document.getElementById("biorhythm");
  const ctx = canvas.getContext("2d");

  canvas.width = canvas.clientWidth;
  canvas.height = canvas.clientHeight;

  const w = canvas.width;
  const h = canvas.height;

  const days = new Date(year, month, 0).getDate();

  ctx.clearRect(0, 0, w, h);

  // 左右余白
  const margin = 20;
  const graphWidth = w - margin * 2;

  // 日付目盛り
  ctx.fillStyle = "#000";
  ctx.font = "12px sans-serif";
  for (let d = 1; d <= days; d++) {
    const x = margin + (d - 1) * (graphWidth / (days - 1));
    if (d % 2 === 1) ctx.fillText(d, x - 3, 12);
  }

  // 記号で波形を描く
  const cycles = [
    { cycle: 23, mark: "★" },
    { cycle: 28, mark: "●" },
    { cycle: 33, mark: "＋" }
  ];

  ctx.font = "16px sans-serif"; // 記号の大きさ

  cycles.forEach(c => {
    for (let d = 1; d <= days; d++) {
      const x = margin + (d - 1) * (graphWidth / (days - 1));
      const date = new Date(year, month - 1, d);
      const yValue = biorhythm(birthDate, date, c.cycle);
      const y = h / 2 - yValue * (h / 2 - 20);

      ctx.fillText(c.mark, x - 5, y + 5);
    }
  });

  // 中央線
  ctx.strokeStyle = "#666";
  ctx.beginPath();
  ctx.moveTo(margin, h / 2);
  ctx.lineTo(w - margin, h / 2);
  ctx.stroke();
}
</script>
